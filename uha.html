<!DOCTYPE html>
<html lang="en" style="width:100%;height: 100%;">
<head>
                <meta charset=" UTF-8">
                <title>3rd Party extension testing</title>
				<script src="https://extensions.merlinsystems.fi/CPC-Demo/CPC.js"></script>		
</head>
<body style="margin: 0;width:100%;height: 100%">
<!-- Below Iframe is loaded inside the extension area, that loads the webpage from www.fonecta.fi -->
<!--iframe id="frame" style="border: 0;width: 100%;height: 100%" src="https://www.fonecta.fi"></iframe-->

<iframe src="https://login-eu-w3.cc.sinch.com/QA1/ecf/latest/communicationpanel/embedded.html" id="cp"  allow="camera;microphone" frameborder="0" scrolling="no" style="height: 100%; width: 70%; float: left; " height="100%" width="70%" align="left"></iframe>  

 <div frameborder="0" scrolling="yes"  style="overflow: hidden; height: 100%; width: 30%; " height="100%" width="30%" align="right">
 
 
 
 
 </div>
<!-- Below script gets the call data, finds the caller phone number (originator) and updates the Iframe url with the new url to fonecta with search query string.-->
<script>
			alert("Test3");
			var _onMessage = function(oEvent) {
				if (oEvent.data.type === "response" && oEvent.data.payload.result !== "error") {
					var data = oEvent.data.payload.value;
					if (data.channel_type === "phone" && data.originator){
						alert(data.originator);
						window.open("https://www.fonecta.fi/haku/" + data.originator, "newWindow", "left=100,top=100,width=600,height=800");
						//document.getElementById("frame").setAttribute("src", "https://www.fonecta.fi/haku/" + data.originator)
						//document.getElementById("frame").src = "https://www.fonecta.fi/haku/" + data.originator;
					}
				}
			}

			window.addEventListener("message", _onMessage);
			document.getElementById("cp").contentWindow.postMessage({type: "init", payload: false, id: "fn-1"}, "*");

</script>

</body>
</html>
